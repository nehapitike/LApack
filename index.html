<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title> SignalR-enabled BLAS2 Web Service </title>
    <!--By Neha Gadigi, Indpendent Study, UCONN Spring 2016 -->
</head>
<body>
    <!--User interface -->
    <p> SignalR-enabled BLAS1(vector-vector multiplication) Web Service </p>
    <p>Matrix #1 <input type="text" id="vec1" size="150" value="{&quot;matrixType&quot;:&quot;RowVector&quot;, &quot;data&quot;: [[1,1,1,1]], &quot;size&quot;: [1, 4]}" /> </p>
    <p>Matrix #2 <input type="text" id="vec2" size="150" value="{&quot;matrixType&quot;:&quot;ColumnVector&quot;, &quot;data&quot;: [[1], [2], [3],[4]], &quot;size&quot;: [4, 1]}" /></p>
    <input type="button" id="send" value="Find the dot product" />
    <p id="Product"></p>
    <p> SignalR-enabled BLAS2(vector-matrix multiplication) Web Service </p>
    <p>Matrix #1 <input type="text" id="vec" size="150" value="{&quot;matrixType&quot;:&quot;RowVector&quot;, &quot;data&quot;: [[1,1,1,1]], &quot;size&quot;: [1, 4]}" /> </p>
    <p>Matrix #2 <input type="text" id="mat" size="150" value="{&quot;matrixType&quot;:&quot;Matrix&quot;, &quot;data&quot;: [[1,1], [2,2], [3,3],[4,4]], &quot;size&quot;: [4, 2]}" /></p>
    <input type="button" id="send1" value="Find the dot product" />
    <p id="Product1"></p>
    <p> SignalR-enabled BLAS2(matrix-vector multiplication) Web Service </p>
    <p>Matrix #1 <input type="text" id="mat1" size="150" value="{&quot;matrixType&quot;:&quot;Matrix&quot;, &quot;data&quot;: [[1,1,1,1], [2,2,2,2], [3,3,3,3],[4,4,4,4]], &quot;size&quot;: [4, 4]}" /> </p>
    <p>Matrix #2 <input type="text" id="vec2" size="150" value="{&quot;matrixType&quot;:&quot;ColumnVector&quot;, &quot;data&quot;: [[1], [2], [3],[4]], &quot;size&quot;: [4, 1]}" /></p>
    <input type="button" id="send2" value="Find the dot product" />
    <p id="Product2"></p>
    <p> SignalR-enabled BLAS3(matrix-matrix multiplication) Web Service </p>
    <p>Matrix #1 <input type="text" id="mat2" size="150" value="{&quot;matrixType&quot;:&quot;Matrix&quot;, &quot;data&quot;: [[1,1], [2,2], [3,3],[4,4]], &quot;size&quot;: [4, 2]}" /> </p>
    <p>Matrix #2 <input type="text" id="mat3" size="150" value="{&quot;matrixType&quot;:&quot;ColumnVector&quot;, &quot;data&quot;: [[1,1],[1,1]], &quot;size&quot;: [2,2]}" /></p>
    <input type="button" id="send3" value="Find the dot product" />
    <p id="Product3"></p>

    <!--Script references -->
    <!--Reference the jQuery library. -->
    <script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
    <!--Reference the SignalR library. -->
    <script src="http://ajax.aspnetcdn.com/ajax/signalr/jquery.signalr-2.2.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="signalr/hubs"></script>
    <!--Add script to communicate with the server and update the page. -->
    <script type="text/javascript">
        $(function () {

            // Declare a proxy to reference the hub.
            var blas = $.connection.bLAS;
            var i = 0;
            var data = [];
            var displayProduct = "[";
            // Start the connection.
            $.connection.hub.start().done(function () {
                
                $('#send').click(function () {
                    var mat1JSON = $('#vec1').val();
                    var mat2JSON = $('#vec2').val();
                    // Call the matrix multiplication method on the hub.
                    blas.server.blas1(mat1JSON, mat2JSON, $.connection.hub.id);
                });

                $('#send1').click(function () {
                    var mat1JSON = $('#vec').val();
                    var mat2JSON = $('#mat').val();
                    //document.getElementById("Product").innerHTML = 'The product matrix is ';
                    // Call the matrix multiplication method on the hub.
                    blas.server.blas2_1(mat1JSON, mat2JSON, $.connection.hub.id);
                });

                $('#send2').click(function () {
                    var mat1JSON = $('#mat1').val();
                    var mat2JSON = $('#vec2').val();
                    //document.getElementById("Product2").innerHTML = 'The product matrix is ';
                    // Call the matrix multiplication method on the hub.
                    blas.server.blas2_2(mat1JSON, mat2JSON, $.connection.hub.id);
                });

                $('#send3').click(function () {
                    var mat1JSON = $('#mat2').val();
                    var mat2JSON = $('#mat3').val();
                    //document.getElementById("Product2").innerHTML = 'The product matrix is ';
                    // Call the matrix multiplication method on the hub.
                    blas.server.blas3(mat1JSON, mat2JSON, $.connection.hub.id);
                });

            });

            // Create a function that the hub can call to display the product of two vectors.

            blas.client.displayBlas1 = function (product) {
                //Parse JSON using JSON.parse  http://www.w3schools.com/json/json_eval.asp
                var productObj = JSON.parse(product);
                document.getElementById("Product").innerHTML = 'The dot product is ' + productObj;

            };
       
            // Create a function that the hub can call to store the product of a row vector and matrix.
            blas.client.displayBlas2_1 = function (product) {     
                //Parse JSON using JSON.parse  http://www.w3schools.com/json/json_eval.asp
                var productObj = JSON.parse(product);               
                data[i] = productObj;
                i++;               
            };

            //Create a function that hub can call to display the final output
            blas.client.displayProduct_1 = function () {
                for (i = 0; i < data.length; i++) {
                    displayProduct += data[i];
                    if (i != data.length - 1) {
                        displayProduct += ','
                    } else displayProduct += ']'
                }
                document.getElementById("Product1").innerHTML = 'The product matrix is ' + displayProduct;
                displayProduct = "[";
                i = 0;
                data = [];
            };
            
            // Create a function that the hub can call to store the product of a matrix and column vector.
            blas.client.displayBlas2_2 = function (product) {
                //Parse JSON using JSON.parse  http://www.w3schools.com/json/json_eval.asp
                var productObj = JSON.parse(product);
                data[i] = productObj;
                i++;
            };

            //Create a function that hub can call to display the final output
            blas.client.displayProduct_2 = function () {
                for (i = 0; i < data.length; i++) {
                    displayProduct += '[' + data[i] + ']';
                    if (i != data.length - 1) {
                        displayProduct += ','
                    } else displayProduct += ']'
                }
                document.getElementById("Product2").innerHTML = 'The product matrix is ' + displayProduct;
                displayProduct = "[";
                i = 0;
                data = [];
            };

            // Create a function that the hub can call to store the product of a two matrices.
            blas.client.displayBlas3 = function (product) {
                //Parse JSON using JSON.parse  http://www.w3schools.com/json/json_eval.asp
                var productObj = JSON.parse(product);
                data[i] = productObj;
                i++;
            };

            //Create a function that hub can call to display the final output
            blas.client.displayProduct_3 = function (product1, product2) {
                var productObj1 = JSON.parse(product1);
                var productObj2 = JSON.parse(product2);
                productObj1 = parseInt(productObj1);
                productObj2 = parseInt(productObj2);
                var z = 0;
                for (i = 0; i < productObj1; i++) {
                    displayProduct += '[';
                    for (j = 0; j < productObj2; j++) {
                        displayProduct += data[z];
                        z++;
                        if (j != productObj2 - 1) {
                            displayProduct += ',';
                        } else displayProduct += ']';

                    }
                    if (z != data.length) {
                        displayProduct += ',';
                    }
                }

                document.getElementById("Product3").innerHTML = 'The product matrix is ' + displayProduct;
                displayProduct = "[";
                i = 0;
                data = [];
            };

        });

    </script>

</body>

</html>
